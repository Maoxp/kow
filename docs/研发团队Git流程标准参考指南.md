# 团队开发流程标准中 Git 参考指南

创建团队之初，研发的各位同事各有各的使用习惯、风格迥异，为严格标准，统一风格，为使用 Git 标准分支开发的团队新人提供一份参考指南。

## 分支说明

开发中开分支是一个很平常的事情，跟吃饭喝水一样，使用频率非常高。
但是，分支管理规范却很重要:heavy_exclamation_mark::heavy_exclamation_mark:，特别是多版本并行开发，上线前移除某些功能等，Branch管的好直接回滚合并就行，管不好代码改半天。

主分支：

> 项目中长期存在的两个分支，它们都具有分支保护权限，只进行合并分支。

* `master`：主干分支，负责记录上线版本的迭代，分支代码与线上代码是完全一致的。
* `develop`：开发分支，该分支记录相对稳定的版本，分支 `feature`、`bugfix`默认从 `develop` 分支创建。

辅助分支：

> 其它分支为临时分支，其完成功能开发之后，需要删除。

* `feature/*`：功能分支，用于开发新的功能，不同的功能创建不同的功能分支，功能分支开发完成并自测通过之后，需要合并到 **develop** 分支，之后删除该分支。

* `bugfix/*`：bug修复分支，用于修复不紧急的bug，普通bug均需要创建bugfix分支开发，开发完成自测没问题后合并到 **develop** 分支后，删除该分支。

* `hotfix/*`：紧急bug修复分支，该分支只有在紧急情况下使用，从**master**分支创建，用于紧急修复线上bug，修复完成后，需要合并该分支到**master**分支以便上线，同时需要再合并到**develop**分支。

### 实际流程

举例： 2024年7月16日，进行任务分解后，P1 项目正式开启新的迭代，版本号为 v1.0.1

一. 开发前，从 `develop` 分支拉取 功能分支
> 保持团队的起始开发分支一致, 从同一个起点出发

特定命名规则的feature分支: feature-功能名-版本号-日期

功能分支: **feature-P1-v1.0.1-SNAPSHOT-20240716**

二. 开发中，团队成员基于 功能分支 拉取 自己临时开发分支
> 团队成员有自己临时开发分支，保证开发灵活性，提测版本稳定性，保证功能分支的健壮稳定性

通过功能分支 **feature-P1-v1.0.1-SNAPSHOT-20240716**，拉取对应团队组员自己开发分支。
⬇️
张三临时功能分支：**feature-P1-v1.0.1-SNAPSHOT-20240716-zhangsan**

三. 提测中，完成开发的成员将个人分支合并回功能分支, 由测试团队基于功能分支进行打包提测
> 团队成员每完成自己任务并验证后，即可合并提测，提高合作效率，加快提测速度，推进项目进度有序进行

提测功能分支: **feature-P1-v1.0.1-SNAPSHOT-20240716**

四. 开发环境测试结束无误，从功能开发分支拉出去掉快照标识，生成预生产分支，模拟生产环境的最后测试
> 保证功能分支灵活性，并兼顾预生产版本分支，如预生产环境遇到问题，可以在功能分支修复并在开发环境验证，解耦保持稳定性

功能分支: **feature-P1-v1.0.1-SNAPSHOT-20240716**  
⬇️
预生产分支: **feature-P1-v1.0.1-20240716**
⬇️
并打出对应 Tag **v1.0.1-20240716**，然后发布预生产。

五. 预生产稳定后，采用蓝绿部署策略，确保新版本无缝切换至生产环境，同时逐步完成各分支的合并，保证版本的连续性和环境的稳定性
> 蓝绿部署是一种**将生产环境直接从当前版本(蓝色)切换到新版本(绿色)的策略**。这要求同时运行两个完全相同的生产环境，但只有一个对外提供服务。

master 分支
⬆️
develop 分支
⬆️
预生产分支: feature-P1-v1.0.1-20240716

## 常用操作命令

### 基本操作

基本命令这里就不多说了，基本跟以前一样，唯一的区别是注意分支是从哪里拉去的以及分支的命名规范。涉及到的命令主要包含以下，大家自己学习：

* git commit
* git add [--all]
* git push
* git pull
* git branch [-d]
* git merge
* git cherry-pick
* git checkout [-b] BRANCH_NAME
* git stash

### git-flow 备忘清单

参考[git-flow 备忘清单](http://danielkummer.github.io/git-flow-cheatsheet/index.zh_CN.html)